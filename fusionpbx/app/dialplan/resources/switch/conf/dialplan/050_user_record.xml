<context name="{v_context}">
	<extension name="user_record" number="" continue="true" app_uuid="43539dd3-d555-4498-835a-3245a0b184ca" enabled="false">
		<condition field="" expression="">
			<action application="set" data="user_record=${user_data ${destination_number}@${domain_name} var user_record}" inline="true"/>
			<action application="set" data="from_user_exists=${user_exists id ${sip_from_user} ${sip_from_host}}" inline="true"/>
		</condition>
		<condition field="${user_exists}" expression="^true$"/>
		<condition field="${user_record}" expression="^all$">
			<action application="set" data="record_session=true" inline="true"/>
		</condition>
		<condition field="${user_exists}" expression="^true$"/>
		<condition field="${call_direction}" expression="^inbound$"/>
		<condition field="${user_record}" expression="^inbound$">
			<action application="set" data="record_session=true" inline="true"/>
		</condition>
		<condition field="${user_exists}" expression="^true$"/>
		<condition field="${call_direction}" expression="^outbound$"/>
		<condition field="${user_record}" expression="^outbound$">
			<action application="set" data="record_session=true" inline="true"/>
		</condition>
		<condition field="${user_exists}" expression="^true$"/>
		<condition field="${call_direction}" expression="^local$"/>
		<condition field="${user_record}" expression="^local$">
			<action application="set" data="record_session=true" inline="true"/>
		</condition>
		<condition field="${from_user_exists}" expression="^true$">
			<action application="set" data="from_user_record=${user_data ${sip_from_user}@${sip_from_host} var user_record}" inline="true"/>
		</condition>
		<condition field="${from_user_exists}" expression="^true$"/>
		<condition field="${from_user_record}" expression="^all$">
			<action application="set" data="record_session=true" inline="true"/>
		</condition>
		<condition field="${from_user_exists}" expression="^true$"/>
		<condition field="${call_direction}" expression="^inbound$"/>
		<condition field="${from_user_record}" expression="^inbound$">
			<action application="set" data="record_session=true" inline="true"/>
		</condition>
		<condition field="${from_user_exists}" expression="^true$"/>
		<condition field="${call_direction}" expression="^outbound$"/>
		<condition field="${from_user_record}" expression="^outbound$">
			<action application="set" data="record_session=true" inline="true"/>
		</condition>
		<condition field="${from_user_exists}" expression="^true$"/>
		<condition field="${call_direction}" expression="^local$"/>
		<condition field="${from_user_record}" expression="^local$">
			<action application="set" data="record_session=true" inline="true"/>
		</condition>
		<condition field="${file_exists ${recordings_dir}/${domain_name}/archive/${strftime(%Y)}/${strftime(%b)}/${strftime(%d)}}" expression="^false$">
			<action application="system" data="mkdir -p ${recordings_dir}/${domain_name}/archive/${strftime(%Y)}/${strftime(%b)}/${strftime(%d)}"/>
		</condition>
		<condition field="record_session" expression="^true$">
			<action application="set" data="api_on_answer=${uuid_record ${uuid} start ${recordings_dir}/${domain_name}/archive/${strftime(%Y)}/${strftime(%b)}/${strftime(%d)}/${uuid}.${record_ext}}"/>
		</condition>
	</extension>
</context>
